@model MyNaati.Ui.ViewModels.PDListing.WizardModel
@{
    ViewBag.Subtitle = "Review";
    Layout = "~/Views/Shared/MasterPages/_PDListingWizardLayout.cshtml";
    ViewBag.BreadCrumb = new List<Tuple<string, string>>
    {
        new Tuple<string, string>("Directory Listing", string.Empty)
    };
}
@section Scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            $(cancelButtons).show();
            $(previousButtons).show();
            $(downloadFormButtons).show();
            $(doneButtons).show();
            $(confirmButtons).show();
        });
    </script>
    @if (Model.IsListing)
    {
        if (Model.PaymentMethodModel.IsOnlineOrder)
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    var $processingPaymentModal = $('#processingPaymentModal');

                    $(downloadFormButtons).hide();
                    $(doneButtons).hide();

                    $(confirmButtons).click(function () {
                        $(confirmButtons).prop('disabled', true);
                        $(cancelButtons).prop('disabled', true);
                        $(previousButtons).prop('disabled', true);
                        $processingPaymentModal.modal('show');
                    });
                });
            </script>
            if (Model.IsProcessed)
            {
                <script type="text/javascript">
                    $(document).ready(function () {
                        $(confirmButtons).prop('disabled', true);
                    });
                </script>
                if (ViewContext.ViewData.ModelState.IsValid)
                {
                    <script type="text/javascript">
                        $(document).ready(function () {
                            $(cancelButtons).prop('disabled', true);
                            $(previousButtons).prop('disabled', true);
                        });
                    </script>
                }
            }
        }
        else if (!Model.PaymentRequired)
        {
            <script type="text/javascript">
                $(document).ready(function () {

                    $(downloadFormButtons).hide();
                    $(doneButtons).hide();

                    $(confirmButtons).click(function () {
                        $(confirmButtons).prop('disabled', true);
                        $(cancelButtons).prop('disabled', true);
                        $(previousButtons).prop('disabled', true);
                    });
                });
            </script>
            if (Model.IsProcessed)
            {
                <script type="text/javascript">
                    $(document).ready(function () {
                        $(confirmButtons).prop('disabled', true);
                    });
                </script>
                if (ViewContext.ViewData.ModelState.IsValid)
                {
                    <script type="text/javascript">
                        $(document).ready(function () {
                            $(cancelButtons).prop('disabled', true);
                            $(previousButtons).prop('disabled', true);
                        });
                    </script>
                }
            }
        }
        else
        {
            <script type="text/javascript">
                $(document).ready(function() {
                    $(confirmButtons).hide();
                    $(doneButtons).prop('disabled', true);

                    $(downloadFormButtons).click(function() {
                        $(cancelButtons).prop('disabled', true);
                        $(previousButtons).prop('disabled', true);

                        var anchors = $('[data-wizard-progress="true"] a');

                        if (anchors.length > 0) {
                            anchors.addClass('no-navigation');
                            anchors.attr('href', '#');
                        }
                    });
                });
            </script>
        }
    }
    else
    {
        <script type="text/javascript">
            $(document).ready(function () {
                $(downloadFormButtons).hide();
                $(doneButtons).hide();
            });
        </script>
    }
}
<div class="row">
    <div class="col-lg-12">
        @if (Model.IsListing)
        {
            if (Model.PaymentMethodModel.IsOnlineOrder)
            {
                <p>
                    Review your practitioner details below.<br />
                    If you are satisfied with your details, select Confirm to process your payment.
                </p>
            }
            else if (!Model.PaymentRequired)
            {
                <p>
                    Review your practitioner details below.<br />
                    If you are satisfied with your details, select Confirm to complete this process.
                </p>
            }
            else
            {
                <p>
                    Review your practitioner details below.<br/>
                    If you are satisfied with your details, download the form. After closing this screen, it will not be possible to retrieve this information.<br/>
                    Print the form, sign and date it, and mail it to NAATI.
                </p>
            }
            if (Model.PaymentRequired)
            {
                <h3 class="text-primary">Fees</h3>
                <p>
                    Your details will be included in the directory until @Html.DisplayFor(d => d.ListingEndDate) for an administration fee of AUD @Html.DisplayFor(f => f.OrderTotalModel.TotalPrice) (inclusive of GST, if applicable).
                </p>
            }
        }
        else
        {
            <p>
                Review your practitioner details below.<br />
                If you are satisfied with the details, select Confirm to update the directory.
            </p>
        }
    </div>
</div>
@{ Html.RenderPartial("_AddressViewPartial", Model); }
@{ Html.RenderPartial("_ContactDetailsViewPartial", Model); }
@{ Html.RenderPartial("_WorkAreasViewPartial", Model); }
@{ Html.RenderPartial("_CredentialViewPartial", Model); }
@if (Model.IsListing)
{
    if (Model.PaymentRequired)
    {
        if (Model.PaymentMethodModel.IsOnlineOrder)
        {
            Html.RenderPartial("_PaymentDetailsViewPartial", Model.PaymentDetailsModel);
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="text-primary">Declaration</h3>
                    <p>You have acknowledged your understanding and agreement to the following:</p>
                </div>
            </div>
            Html.RenderPartial("_PDDeclarationPartial", Model);
            Html.RenderPartial("_ProcessingPaymentMessagePartial");
        }
        else
        {
            Html.RenderPartial("_PaymentMethodViewPartial", Model.PaymentMethodModel);
        }
    }
}
