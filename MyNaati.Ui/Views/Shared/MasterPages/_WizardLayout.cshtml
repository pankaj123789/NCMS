@{
    var useSideMenuLayout = ((bool?) ViewBag.UseSideMenu).GetValueOrDefault();

    Layout = string.Format("~/Views/Shared/MasterPages/_{0}Layout.cshtml", useSideMenuLayout ? "SideMenu" : string.Empty);

    var confirmDisabledMarkup = !ViewData.ModelState.IsValid ? "disabled=\"disabled\"" : string.Empty;
    var validationSummary = Html.ValidationSummary() != null ? Html.ValidationSummary().ToString() : string.Empty;
}
@section Head
{
    @RenderSection("Head", false)
}
@if (useSideMenuLayout)
{
    @section SideMenu
    {
        @RenderSection("SideMenu", false)
    }
}
@section Scripts
{
    @{ Html.RenderPartial("_CommonWizardScript"); }
    <script type="text/javascript">
        $(function () {
            $(previousButtons).click(function () {
                $(formSelector).submit();
            });
        });
        function handleCancel() {
            $('#cancelConfirmModal').modal('show');
        }
    </script>
    @RenderSection("Scripts", false)
}
<div class="col-lg-12 v-offset-xs-4">
    @using (Html.BeginForm())
    {
        @RenderSection("BeforeDefaultForm", false)
        <div class="row">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-sm-6">
                        <h3 class="text-primary">@ViewBag.Subtitle</h3>
                    </div>
                    <div class="col-sm-6 top">
                        @WizardButtons(confirmDisabledMarkup)
                    </div>
                </div>
                @if (!string.IsNullOrEmpty(validationSummary))
                {
                    <div class="row">
                        <div class="col-lg-12">
                            @Html.ValidationSummary()
                        </div>
                    </div>
                }
                <div class="row">
                    <div class="col-lg-12">
                        @RenderBody()
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-lg-12">
                        @WizardButtons(confirmDisabledMarkup)
                    </div>
                </div>
            </div>
        </div>
    }
    @RenderSection("AfterDefaultForm", false)
    <div id="cancelConfirmModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Cancel Application?</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-12">
                            <p>
                                Are you sure you wish to discard your application?
                                <br />
                                <br />
                                Any details entered will be lost.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="gotoButton('cancel');">Yes</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                </div>
            </div>
        </div>
    </div>
</div>
@helper WizardButtons(string confirmDisabledMarkup)
{
    <div class="wizard-buttons">
        <input class="btn btn-danger" type="button" value="Cancel" style="display: none;" />
        <input class="btn btn-primary" type="button" value="Previous" style="display: none;" />
        <input class="btn btn-success" type="button" value="Download Form" style="display: none;" />
        <input class="btn btn-primary" type="submit" value="Next" style="display: none;" />
        <input class="btn btn-default" type="submit" value="Done" style="display: none;" />
        <input class="btn btn-primary" type="submit" value="Submit" style="display: none;" />
        <input class="btn btn-primary" type="submit" value="Confirm" @confirmDisabledMarkup style="display: none;" />
    </div>
}
